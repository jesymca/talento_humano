<style>
    /* Estilos generales */
    .container {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
  
    .row {
      display: flex;
      justify-content: center;
    }
  
    .col {
      width: 100%;
    }
  
    .text-center {
      text-align: center;
    }
  
    /* Estilos para el input y botón de búsqueda */
    .input-busqueda {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      text-align: center;
    }
  
    .btn-buscar {
      width: 100%;
      padding: 10px;
      margin-top: 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  
    .btn-buscar:hover {
      background-color: #0056b3;
    }
  
    /* Estilos para los botones de imprimir y descargar */
    .button-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
  
    .btn-imprimir,
    .btn-descargar {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  
    .btn-imprimir {
      background-color: #007bff;
      color: white;
    }
  
    .btn-imprimir:hover {
      background-color: #0056b3;
    }
  
    .btn-descargar {
      background-color: #28a745;
      color: white;
    }
  
    .btn-descargar:hover {
      background-color: #218838;
    }
  
    /* Estilos para la constancia */
    .constancia {
      border: 1px solid #000;
      padding: 20px;
      margin-top: 20px;
      background-color: #f9f9f9;
    }
  
    .constancia h2 {
      text-align: center;
      margin-bottom: 20px;
    }
  
    .constancia p {
      margin: 10px 0;
    }
  
    .text {
      font-size: 12px; /* Tamaño de fuente base */
      font-family: Arial, sans-serif; /* Fuente por defecto */
      fill: black; /* Color de texto por defecto */
    }
  </style>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">


<div class="container" id="imprimir" style="display: none;">
  <div class="button-container">
    <button class="btn-imprimir" id="botonImprimir" type="button"><i class="bi bi-printer"></i> Imprimir</button>
    <button class="btn-descargar" id="botonDescargar" type="button"><i class="bi bi-cloud-arrow-down"></i>
      Descargar</button>
  </div>
  <div id="areaImprimir">
    <div id="constancia-container"></div>
  </div>
</div>

<div id="progressContainer"
  style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center;">
  <div style="background-color: white; padding: 20px; border-radius: 10px;">
    Descargando...
  </div>
</div>
  
    <div class="container">
      <div class="row">
        <div class="col">
          <label for="busqueda">
            <p class="text-center">
              Busca por <strong>Cédula (ej: V-12345678)</strong>:
            </p>
          </label>
          <input class="input-busqueda" id="busqueda" placeholder="V-12345678" type="text" pattern="[^\s]+"
            oninput="this.value = this.value.replace(/\s/g, '');" />
          <button class="btn-buscar" onclick="buscarEmpleado()"><i class="bi bi-search"></i> Buscar</button>
          <div id="resultados"></div>
        </div>
      </div>
    </div>
  
  
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  
    <script>

function ofuscado() {
    // La URL codificada en base64
    const encodedUrl = 'aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2plc3ltY2EvdGFsZW50b19odW1hbm8vbWFpbi9jb25zdGFuY2lhc190cmFiYWpvLmNzdg==  ';
    
    // Decodificar la URL desde base64
    const decodedUrl = atob(encodedUrl);
    
    return decodedUrl;
}

const Url = ofuscado();


  
      // Obtener el parámetro ID de la URL
      const urlParams = new URLSearchParams(window.location.search);
      const idCodigo = urlParams.get('Codigo');
  
      // Obtener el parámetro cédula de la URL (si se necesita)
      const cedulaBusqueda = urlParams.get('Cedula');
  
      fetch(Url)
        .then(response => response.text())
        .then(csvData => {
          const resultados = []; // Array para almacenar los resultados
          const rows = csvData.split('\n'); // Dividir el CSV por líneas
          const headers = rows[0].split(','); // Obtener los encabezados
  
          for (let i = 1; i < rows.length; i++) { // Iterar sobre las filas (excluyendo la primera)
            const rowData = rows[i].split(',');
            const empleado = {};
            for (let j = 0; j < headers.length; j++) {
              empleado[headers[j]] = rowData[j];
            }
  
            // Filtrar por ID si se proporciona
            if (idCodigo && empleado.Codigo === idCodigo) {
              resultados.push(empleado);
              break; // Detener la búsqueda si se encuentra el ID
            }
  
            // Filtrar por cédula si se proporciona y no se busca por ID
            if (cedulaBusqueda && !idCodigo && empleado.Cedula === cedulaBusqueda) {
              resultados.push(empleado);
            }
          }
  
          // Mostrar los resultados en la página
          const resultadosDiv = document.getElementById('resultados');
          if (resultados.length > 0) {
            const empleado = resultados[0];
            // const remuneracionEnLetras = NumeroALetras(parseFloat(empleado.RemuneracionMensual.replace(',', '.')));
            // <p class="card-text"><strong>Remuneración Mensual en Letras:</strong> ${remuneracionEnLetras}</p>
            resultadosDiv.innerHTML = `
                        <div class="card mt-3">
                            <div class="card-body">
                                <h2 class="card-title">Constancia Valida</h2>
                                <p class="card-text"><strong>Serial:</strong> ${empleado.Codigo}</p>
                                <p class="card-text"><strong>Nombre:</strong> ${empleado.Nombre}</p>
                                <p class="card-text"><strong>Cédula:</strong> ${empleado.Cedula}</p>
                                <p class="card-text"><strong>Categoría:</strong> ${empleado.Categoria}</p>
                                <p class="card-text"><strong>Cargo:</strong> ${empleado.Cargo}</p>
                               
                                <p class="card-text"><strong>Desde:</strong> ${empleado.Desde}</p>
                                <p class="card-text"><strong>Remuneración Mensual:</strong> ${empleado.RemuneracionMensual}</p>
                            </div>
                        </div>
                    `;
          } else {
            resultadosDiv.innerHTML =
              '<div class="alert alert-danger mt-3" role="alert"><i class="bi bi-exclamation-diamond"></i> Ingrese algun dato a buscar.</div>';
          }
        })
        .catch(error => {
          console.error('Error al cargar el archivo CSV:', error);
          document.getElementById('resultados').innerHTML =
            '<div class="alert alert-danger mt-3" role="alert"><i class="bi bi-exclamation-diamond"></i> Error al cargar los datos.</div>';
        });
  
  
      ///////////////////
  
  
      document.addEventListener('DOMContentLoaded', function () {
        // Obtener el botón de impresión y descarga
        var botonImprimir = document.getElementById('botonImprimir');
        var botonDescargar = document.getElementById('botonDescargar');
  
        // Agregar EventListener al botón de impresión
        botonImprimir.addEventListener('click', function () {
          printDiv('areaImprimir');
        });
  
        // Agregar EventListener al botón de descarga
        botonDescargar.addEventListener('click', function () {
          mostrarProgreso();
          descargarPNG('areaImprimir');
        });
      });
  
      function mostrarProgreso() {
        var progressContainer = document.getElementById('progressContainer');
        progressContainer.style.display = 'flex';
      }
  
      function ocultarProgreso() {
        var progressContainer = document.getElementById('progressContainer');
        progressContainer.style.display = 'none';
      }
  
  
  
  
      function printDiv(nombreDiv) {
        var contenido = document.getElementById(nombreDiv).innerHTML;
        var contenidoOriginal = document.body.innerHTML;
  
        document.body.innerHTML = contenido;
        window.print();
        document.body.innerHTML = contenidoOriginal;
  
        // Reinicia la página después de imprimir
        location.reload();
      }
  
      function descargarPNG(nombreDiv) {
        // Obtén el SVG del contenedor.
        const svgElement = document.getElementById(nombreDiv).querySelector('svg');//<- busca la  etiqueta <svg> dentro  del contenedor
  
        if (!svgElement) {
          console.error('No se encontró el elemento SVG.');
          ocultarProgreso();
          return;
        }
  
  
        //Obtener las dimensiones del SVG
        const svgWidth = svgElement.viewBox.baseVal.width;
        const svgHeight = svgElement.viewBox.baseVal.height;
  
        html2canvas(document.getElementById(nombreDiv),
          {
            allowTaint: false,
            useCORS: true,
            width: svgWidth, //<- establece el ancho del canvas
            height: svgHeight, //<- establece el alto del  canvas
            scale: 1.8, //<- valor de  escala. Experimentar con valores mayores si  es necesario.
          })
          .then(function (canvas) {
            var link = document.createElement('a');
            link.download = 'certificado.png';
            link.href = canvas.toDataURL();
            link.click();
            ocultarProgreso()
          });
      }
  
      // Agregar evento para convertir a mayúsculas al escribir
      const inputBusqueda = document.getElementById('busqueda');
      inputBusqueda.addEventListener('input', () => {
        // Solo ocultar si el término de búsqueda ha cambiado
        if (inputBusqueda.value.trim() !== ultimoTerminoBusqueda) {
          document.getElementById('resultados').innerHTML = '';  // Limpiar resultados
          document.getElementById('imprimir').style.display = 'none'; // Ocultar área de impresión si está visible
        }
        inputBusqueda.value = inputBusqueda.value.toUpperCase(); // Mantener mayúsculas
      });
  
      let ultimoTerminoBusqueda = "";
  
  
      function buscarEmpleado() {
        const terminoBusqueda = document.getElementById('busqueda').value.trim();
        const resultadosDiv = document.getElementById('resultados');
        resultadosDiv.innerHTML = ''; // Limpiar resultados previos
  
        if (!terminoBusqueda) {
          resultadosDiv.innerHTML =
            '<div class="alert alert-danger mt-3" role="alert"><i class="bi bi-exclamation-diamond"></i> Ingrese una cédula válida.</div>';
          return; // Terminar la función si el campo de búsqueda está vacío
        }
  
        fetch(Url) // Cambia la URL por la de tu CSV
          .then(response => response.text())
          .then(csvData => {
            const resultados = [];
            const rows = csvData.split('\n');
            const headers = rows[0].split(',');
  
            for (let i = 1; i < rows.length; i++) {
              const rowData = rows[i].split(',');
              const empleado = {};
              for (let j = 0; j < headers.length; j++) {
                empleado[headers[j]] = rowData[j];
              }
  
              // Buscar por cédula
              if (empleado.Codigo === terminoBusqueda || empleado.Cedula === terminoBusqueda) {
                resultados.push(empleado);
              }
            }
  
            if (resultados.length > 0) {
              const empleado = resultados[0];
              // const remuneracionEnLetras = NumeroALetras(parseFloat(empleado.RemuneracionMensual.replace(',', '.')));
              // <p class="card-text"><strong>Remuneración Mensual en Letras:</strong> ${remuneracionEnLetras}</p>
              resultadosDiv.innerHTML = `
                        <div class="card mt-3">
                            <div class="card-body">
                                <h2 class="card-title">Empleado Encontrado</h2>
                                <p class="card-text"><strong>Nombre:</strong> ${empleado.Nombre}</p>
                                <p class="card-text"><strong>Cédula:</strong> ${empleado.Cedula}</p>
                                <p class="card-text"><strong>Categoría:</strong> ${empleado.Categoria}</p>
                                <p class="card-text"><strong>Cargo:</strong> ${empleado.Cargo}</p>
                              
                                <p class="card-text"><strong>Desde:</strong> ${empleado.Desde}</p>
                                <p class="card-text"><strong>Remuneración Mensual:</strong> ${empleado.RemuneracionMensual}</p>
                                
                                <p class="card-text"><strong>Serial:</strong> ${empleado.Codigo}</p>
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="generarConstancia('${empleado.Cedula}')"><i class="bi bi-file-earmark-text"></i> Generar Constancia</button>
                    `;
            } else {
              resultadosDiv.innerHTML =
                '<div class="alert alert-danger mt-3" role="alert"><i class="bi bi-exclamation-diamond"></i> No se encontró el empleado.</div>';
            }
          });
      }
  
  
      /*************************************************************/
      // NumeroALetras
      // The MIT License (MIT)
      // 
      // Copyright (c) 2015 Luis Alfredo Chee 
      // 
      // Permission is hereby granted, free of charge, to any person obtaining a copy
      // of this software and associated documentation files (the "Software"), to deal
      // in the Software without restriction, including without limitation the rights
      // to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
      // copies of the Software, and to permit persons to whom the Software is
      // furnished to do so, subject to the following conditions:
      // 
      // The above copyright notice and this permission notice shall be included in all
      // copies or substantial portions of the Software.
      // 
      // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
      // IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
      // FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
      // AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
      // LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
      // OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
      // SOFTWARE.
      // 
      // @author Rodolfo Carmona
      // @contributor Jean (jpbadoino@gmail.com)
      /*************************************************************/
  
      function Unidades(num) {
        switch (num) {
          case 1: return "UN";
          case 2: return "DOS";
          case 3: return "TRES";
          case 4: return "CUATRO";
          case 5: return "CINCO";
          case 6: return "SEIS";
          case 7: return "SIETE";
          case 8: return "OCHO";
          case 9: return "NUEVE";
        }
        return "";
      }
  
      function Decenas(num) {
        let decena = Math.floor(num / 10);
        let unidad = num - (decena * 10);
  
        switch (decena) {
          case 1:
            switch (unidad) {
              case 0: return "DIEZ";
              case 1: return "ONCE";
              case 2: return "DOCE";
              case 3: return "TRECE";
              case 4: return "CATORCE";
              case 5: return "QUINCE";
              default: return "DIECI" + Unidades(unidad);
            }
          case 2:
            switch (unidad) {
              case 0: return "VEINTE";
              default: return "VEINTI" + Unidades(unidad);
            }
          case 3: return DecenasY("TREINTA", unidad);
          case 4: return DecenasY("CUARENTA", unidad);
          case 5: return DecenasY("CINCUENTA", unidad);
          case 6: return DecenasY("SESENTA", unidad);
          case 7: return DecenasY("SETENTA", unidad);
          case 8: return DecenasY("OCHENTA", unidad);
          case 9: return DecenasY("NOVENTA", unidad);
          case 0: return Unidades(unidad);
        }
      }
  
      function DecenasY(strSin, numUnidades) {
        if (numUnidades > 0)
          return strSin + " Y " + Unidades(numUnidades);
        return strSin;
      }
  
      function Centenas(num) {
        let centenas = Math.floor(num / 100);
        let decenas = num - (centenas * 100);
  
        switch (centenas) {
          case 1:
            if (decenas > 0)
              return "CIENTO " + Decenas(decenas);
            return "CIEN";
          case 2: return "DOSCIENTOS " + Decenas(decenas);
          case 3: return "TRESCIENTOS " + Decenas(decenas);
          case 4: return "CUATROCIENTOS " + Decenas(decenas);
          case 5: return "QUINIENTOS " + Decenas(decenas);
          case 6: return "SEISCIENTOS " + Decenas(decenas);
          case 7: return "SETECIENTOS " + Decenas(decenas);
          case 8: return "OCHOCIENTOS " + Decenas(decenas);
          case 9: return "NOVECIENTOS " + Decenas(decenas);
        }
        return Decenas(decenas);
      }
  
      function Seccion(num, divisor, strSingular, strPlural) {
        let cientos = Math.floor(num / divisor);
        let resto = num - (cientos * divisor);
        let letras = "";
  
        if (cientos > 0) {
          if (cientos > 1)
            letras = Centenas(cientos) + " " + strPlural;
          else
            letras = strSingular;
        }
  
        if (resto > 0)
          letras += " " + Centenas(resto);
  
        return letras;
      }
  
      function Miles(num) {
        let divisor = 1000;
        let cientos = Math.floor(num / divisor);
        let resto = num - (cientos * divisor);
        let strMiles = Seccion(cientos, 1, "UN MIL", "MIL");
        let strCentenas = Centenas(resto);
  
        if (strMiles === "")
          return strCentenas;
  
        return strMiles + " " + strCentenas;
      }
  
      function Millones(num) {
        let divisor = 1000000;
        let cientos = Math.floor(num / divisor);
        let resto = num - (cientos * divisor);
        let strMillones = Seccion(cientos, 1, "UN MILLON", "MILLONES");
        let strMiles = Miles(resto);
  
        if (strMillones === "")
          return strMiles;
  
        return strMillones + " " + strMiles;
      }
  
      function NumeroALetras(num) {
        let data = {
          numero: num,
          enteros: Math.floor(num),
          centavos: Math.round((num - Math.floor(num)) * 100),
          letrasCentavos: "",
          letrasMonedaPlural: 'BOLIVARES',
          letrasMonedaSingular: 'BOLIVAR',
          letrasMonedaCentavoPlural: "CENTIMOS",
          letrasMonedaCentavoSingular: "CENTIMO"
        };
  
        if (data.centavos > 0) {
          data.letrasCentavos = "CON " + (function () {
            if (data.centavos == 1)
              return Decenas(data.centavos) + " " + data.letrasMonedaCentavoSingular;
            else
              return Decenas(data.centavos) + " " + data.letrasMonedaCentavoPlural;
          })();
        }
  
        if (data.enteros == 0)
          return "CERO " + data.letrasMonedaPlural + " " + data.letrasCentavos;
        if (data.enteros == 1)
          return Millones(data.enteros) + " " + data.letrasMonedaSingular + " " + data.letrasCentavos;
        else
          return Millones(data.enteros) + " " + data.letrasMonedaPlural + " " + data.letrasCentavos;
      }
  
      // Ejemplo de uso:
      //console.log(NumeroALetras(15));
  
  
      function generarConstancia(cedula) {
    fetch(Url)
        .then(response => response.text())
        .then(csvData => {
            const rows = csvData.split('\n');
            const headers = rows[0].split(',');

            // Buscar el empleado por cédula
            const empleadoEncontrado = rows.slice(1).map(row => {
                const rowData = row.split(',');
                const empleado = {};
                headers.forEach((header, index) => {
                    empleado[header] = rowData[index];
                });
                return empleado;
            }).find(empleado => empleado.Cedula === cedula);

            if (empleadoEncontrado) {
                // Generar el SVG
                const svg = generarSVG(empleadoEncontrado);
                const contenedor = document.getElementById('constancia-container');
                contenedor.innerHTML = svg; // Insertar el SVG en el contenedor
                contenedor.style.display = 'block';

                // Llama a una función dentro de setTimeout()
                setTimeout(() => {
                    document.getElementById('imprimir').style.display = 'block';

                    // Accede a los <g> dentro del SVG (que YA está en el DOM)
                    const contenidoDiv = document.getElementById('contenido');

                    // Formatear el texto dinámicamente
                    const textoConstancia = `
    Quien suscribe, Directora de Gestión de Talento Humano de la Universidad Politécnica Territorial Puerto Cabello, 
    a través del presente hace constar que el ciudadano (a) {${empleadoEncontrado.Nombre}}, Titular de la Cédula de Identidad No. {${empleadoEncontrado.Cedula}}, presta servicio en esta institución como miembro del personal {${empleadoEncontrado.Categoria}}, Cargo {${empleadoEncontrado.Cargo}}, 
    desde el {${empleadoEncontrado.Desde}}, percibiendo una remuneración mensual de: (Bs {${empleadoEncontrado.RemuneracionMensual}}) en letras: {${NumeroALetras(empleadoEncontrado.RemuneracionMensual)}}.
`;

                    // Agregar el texto al SVG
                    agregarTextoMultilinea(textoConstancia, 15, 65, 185, contenidoDiv);  // Ajuste: maxWidth a 185 para 794px ancho de pagina
                }, 0);
            } else {
                // Manejar el caso donde no se encuentra el empleado
                console.error("Empleado no encontrado");
            }
        })
        .catch(error => console.error("Error al cargar el CSV:", error));
}



function agregarTextoMultilinea(texto, x, y, maxWidth, contenedor) {
  const lineas = [];
  const palabras = texto.split(' ');

  let lineaActual = '';
  let dentroDeLlaves = false; // Para rastrear si estamos dentro de {}
  let contenidoLlaves = ''; // Para acumular el contenido dentro de {}

  palabras.forEach(palabra => {
    // Verificar si la palabra contiene una llave de apertura {
    if (palabra.includes('{') && !dentroDeLlaves) {
      dentroDeLlaves = true;
      contenidoLlaves = '';
      palabra = palabra.replace('{', ''); // Eliminar la llave de apertura
    }

    // Verificar si la palabra contiene una llave de cierre }
    if (palabra.includes('}') && dentroDeLlaves) {
      dentroDeLlaves = false;
      contenidoLlaves += ' ' + palabra.replace('}', '');

      // Si el contenido entre llaves es muy largo, dividirlo en múltiples líneas
      let palabrasLlaves = contenidoLlaves.split(' ');
      let lineaLlavesActual = '';

      palabrasLlaves.forEach(palabraLlave => {
        if ((lineaLlavesActual + palabraLlave + ' ').length * 1.5 >= maxWidth) { //AQUI
          // Lógica para agregar negrita al final y al principio de líneas cortadas
          let lineaConNegrita = ` {${lineaLlavesActual.trim()}} `;

          if (lineaActual) {
            // Insertar al final de la línea existente
            if ((lineaActual + lineaConNegrita).length * 1.5 >= maxWidth) {  //AQUI
              lineas.push(lineaActual.trim());
              lineaActual = lineaConNegrita;
            } else {
              lineaActual += lineaConNegrita;
            }
          } else {
            // Insertar en una nueva línea
            lineas.push(lineaConNegrita.trim());
            lineaActual = "";
          }

          lineaLlavesActual = palabraLlave + ' ';
        } else {
          lineaLlavesActual += palabraLlave + ' ';
        }
      });

      // Agregar la última parte del contenido entre llaves
      if (lineaLlavesActual) {
        let lineaConNegrita = ` {${lineaLlavesActual.trim()}} `;
        if ((lineaActual + lineaConNegrita).length * 1.5 >= maxWidth) {  //AQUI
          lineas.push(lineaActual.trim());
          lineaActual = lineaConNegrita;
        } else {
          lineaActual += lineaConNegrita;
        }
      }

      contenidoLlaves = '';
      return;
    }

    // Si estamos dentro de llaves, acumular el contenido
    if (dentroDeLlaves) {
      contenidoLlaves += ' ' + palabra;
      return;
    }

    // Si no estamos dentro de llaves, procesar la palabra normalmente
    const pruebaLinea = lineaActual + palabra + ' ';
    if (pruebaLinea.length * 1.5 <= maxWidth) {  //AQUI
      lineaActual = pruebaLinea;
    } else {
      lineas.push(lineaActual.trim());
      lineaActual = palabra + ' ';
    }
  });

  // Agregar la última línea si queda contenido
  if (lineaActual.trim() !== '') {
    lineas.push(lineaActual.trim());
  }

  // Procesar cada línea y agregar el texto al SVG
  lineas.forEach((linea, index) => {
    const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    textElement.setAttribute('x', x);
    textElement.setAttribute('y', y + index * 5);  //AQUI

    // Dividir la línea en partes normales y partes en negrita
    const partes = linea.split(/(\{.*?\})/);
    partes.forEach(parte => {
      if (parte.startsWith('{') && parte.endsWith('}')) {
        // Parte en negrita
        const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
        tspan.textContent = parte.slice(1, -1);
        tspan.setAttribute('font-weight', 'bold');
        textElement.appendChild(tspan);
      } else if (parte.trim() !== "") {
        // Parte normal
        const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
        tspan.textContent = parte;
        textElement.appendChild(tspan);
      }
    });

    contenedor.appendChild(textElement);
  });
}

  
      function generarSVG(empleado) {
        let svg = '';
        // CONSTANCIA DE TRABAJO
        if (empleado.Documento === "CONSTANCIA") {
          const ancho = 794; // Ancho de la página en puntos (8.5 pulgadas * 96 DPI)
          const alto = 1123; // Alto de la página en puntos (11 pulgadas * 96 DPI)
          const margen = 50;  // Margen en puntos
          const anchoUtil = ancho - 2 * margen; // Ancho disponible para el contenido
          const titulo = "CONSTANCIA DE TRABAJO";



          svg = `
          <svg
            width="8.5in"
   height="11in"
   viewBox="0 0 215.9 279.4"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="CONSTANCIA DE TRABAJO.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:cc="http://creativecommons.org/ns#">
   <style
     id="style1"> 
 #contenido text {
            text-anchor: start; /* Alineación horizontal (start, middle, end) */
            font-size: 3px; /* Tamaño de la fuente */
            text-align: justify; /* No aplica directamente en SVG, se simula con textLength */
            textLength="100%"; /* Justificación simulada */
            lengthAdjust="spacingAndGlyphs"; /* Ajuste de espaciado y glifos */
        }
      </style>
     <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#999999"
     borderopacity="1"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="0.7974891"
     inkscape:cx="277.74674"
     inkscape:cy="-183.70157"
     inkscape:window-width="1600"
     inkscape:window-height="842"
     inkscape:window-x="0"
     inkscape:window-y="30"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1" /><defs
     id="defs1" /><g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1">
     <text
       xml:space="preserve"
       style="font-size:4.93889px;text-align:start;writing-mode:lr-tb;direction:ltr;text-anchor:start;fill:#000000;stroke-width:0.264583"
       x="105.09137"
       y="54.201714"
       id="TITULO"
       inkscape:label="TITULO"><desc
         id="desc1">TITULO</desc><title
         id="title1">TITULO</title><tspan
         sodipodi:role="line"
         id="tspan1"
         style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:4.93889px;font-family:sans-serif;-inkscape-font-specification:'sans-serif Bold';text-align:center;text-anchor:middle;stroke-width:0.264583"
         x="105.09137"
         y="54.201714">${titulo}</tspan></text>
       
<g class="text" id="contenido" transform="translate(0, 0)"
    </g>
       
       
       <metadata
     id="metadata1"><rdf:RDF><cc:License
         rdf:about="http://creativecommons.org/licenses/by-nc/4.0/"><cc:permits
           rdf:resource="http://creativecommons.org/ns#Reproduction" /><cc:permits
           rdf:resource="http://creativecommons.org/ns#Distribution" /><cc:requires
           rdf:resource="http://creativecommons.org/ns#Notice" /><cc:requires
           rdf:resource="http://creativecommons.org/ns#Attribution" /><cc:prohibits
           rdf:resource="http://creativecommons.org/ns#CommercialUse" /><cc:permits
           rdf:resource="http://creativecommons.org/ns#DerivativeWorks" /></cc:License><cc:Work
         rdf:about=""><cc:license
           rdf:resource="http://creativecommons.org/licenses/by-nc/4.0/" /></cc:Work></rdf:RDF></metadata>
        </svg>
          `;
        }
  
        return svg; // Asegúrate de retornar el SVG generado
      }
    </script>

